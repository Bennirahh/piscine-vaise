{% extends 'base.html.twig' %}

{% block title %}Réservation{% endblock %}

{% block body %}
<h1>Créer une nouvelle réservation</h1>

{{ form_start(form) }}

<!-- Champ pour choisir le type de réservation -->
<div class="form-group">
    {{ form_label(form.reservationCategory) }}
    {{ form_widget(form.reservationCategory) }}
</div>

<!-- Champ pour la date de réservation -->
<div class="form-group">
    {{ form_label(form.reservationDate) }}
    {{ form_widget(form.reservationDate) }}
</div>

<!-- Champ pour le nombre de personnes -->
<div class="form-group">
    {{ form_label(form.reservationPeaopleNumber) }}
    {{ form_widget(form.reservationPeaopleNumber) }}
</div>

<!-- Champ pour le prix -->
<div class="form-group">
    {{ form_label(form.reservationPrice) }}
    {{ form_widget(form.reservationPrice) }}
</div>

<!-- Section pour l'événement (affichée uniquement si "Event" est sélectionné) -->
<div id="eventSection" class="form-group" style="display: none;">
    {{ form_label(form.event) }}
    {{ form_widget(form.event) }}
</div>

<!-- Section pour le lieu (affichée uniquement si "Location" est sélectionné) -->
<div id="locationSection" class="form-group" style="display: none;">
    {{ form_label(form.location) }}
    {{ form_widget(form.location) }}
</div>

<!-- Section pour l'équipement (affichée uniquement si "Equipement" est sélectionné) -->
<div id="equipementSection" class="form-group" style="display: none;">
    {{ form_label(form.equipement) }}
    {{ form_widget(form.equipement) }}
</div>

<!-- Bouton de soumission -->
<div class="form-group">
    {{ form_widget(form.save) }}
</div>

{{ form_end(form) }}

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Récupérer les éléments nécessaires
        var reservationCategoryField = document.getElementById("{{ form.reservationCategory.vars.id }}");
        var eventSection = document.getElementById("eventSection");
        var locationSection = document.getElementById("locationSection");
        var equipementSection = document.getElementById("equipementSection");

        // Fonction pour afficher ou masquer les sections en fonction de la catégorie sélectionnée
        function toggleSections() {
            var selectedCategory = reservationCategoryField.value;
            
            // Masquer toutes les sections par défaut
            eventSection.style.display = 'none';
            locationSection.style.display = 'none';
            equipementSection.style.display = 'none';

            // Afficher la section correspondante en fonction de la catégorie sélectionnée
            if (selectedCategory === 'event') {
                eventSection.style.display = 'block';
            } else if (selectedCategory === 'location') {
                locationSection.style.display = 'block';
            } else if (selectedCategory === 'equipement') {
                equipementSection.style.display = 'block';
            }
        }

        // Initialiser l'affichage en fonction de la catégorie pré-sélectionnée
        toggleSections();

        // Ajouter un écouteur d'événement pour changer l'affichage lorsque l'utilisateur change la catégorie
        reservationCategoryField.addEventListener('change', toggleSections);
    });
</script>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const eventSelect = document.querySelector('#form_event'); // Vérifiez que l'ID du champ 'event' est correct
    const priceInput = document.querySelector('#form_reservationPrice'); // Vérifiez que l'ID du champ 'prix' est correct

    // Vérifier si l'élément 'eventSelect' existe avant d'ajouter l'événement
    if (eventSelect) {
        eventSelect.addEventListener('change', function() {
            const selectedOption = eventSelect.options[eventSelect.selectedIndex];
            const price = selectedOption.dataset.price || 0; // Obtenir le prix depuis l'attribut data-price
            priceInput.value = price; // Mettre à jour la valeur du champ prix
        });
    }
});

</script>



{% endblock %}
